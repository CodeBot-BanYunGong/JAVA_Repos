### 1. 残差到底是什么？
简化一句话：
残差 = 当前数值解 还没有完全满足 对应控制方程的程度。
在离散化之后，每个控制方程（质量守恒、动量守恒、能量守恒…）都被写成了

Σ( 系数 × 邻域未知量 )  =  源项
理想情况下左、右两边应该 完全相等。
但求解迭代过程中它们会有差值，这个差值加和后就叫 Residual。

---

### 2. 常见残差名称与含义
| GUI 曲线标签               | 	对应偏微分方程                            | 	物理意义        |
|:-----------------------|:------------------------------------|:-------------|
| Continuity (或 Mass)	   | ∂ρ/∂t + ∇·(ρu) = 0	                 | 质量守恒（压缩/不可压） |
| X-, Y-, Z-Momentum	    | ρ(∂u/∂t + u·∇u) = −∂p/∂x + μ∇²u + …	| 各方向动量守恒      |
| Energy / Total Energy	 | ρ(∂h/∂t + u·∇h) = ∇·(k∇T) + S	      | 能量守恒 / 温度方程  |
| k, ε / ω, SST-kω	      | 湍流模型附加方程	                           | 湍动动能、耗散率等    |
| Scalar-n	              | 被动或化学物质质量分数 / 体积分数方程	               | 质量传输         |
| Volume Fraction (VOF)	 | 相分率传输	                              | 两相/多相界面      |
| Radiation-G, h_r	      | 辐射势 / Enthalpy	                     | 辐射传热         |

「残差下跌得越多 → 方程满足得越好 → 解越接近真正收敛」。
	
>在残差（Residual）曲线里看到
>Tke、Tdr 这两个名字，一般说明你启用了 k-ε（或 SST k-ω）类湍流模型。
>
>它们其实就是这两个附加方程的残差：
>  * Tke = Turbulent kinetic energy → 符号 k （单位 m²/s²）
>  * Tdr = Turbulent dissipation rate → 符号 ε
>
>(你用的是 k-ω / SST 模型，软件仍可能把 ω 的残差列在 “Tdr” 那一行 —— 此时它代表的是 Specific Dissipation Rate ω，单位 1/s）
>
>理解它们可以从三层角度来把握：
>#### 1. 物理意义 ─────────
>	 
>##### Tke (k)： 
>  - 表示单位质量湍流脉动速度的动能
>  - 数值越大，说明流场里“旋涡能量”越旺盛
>
>##### Tdr (ε 或 ω)：
>  - 表示湍动动能被粘性耗散成内能的速率
>  - ε 量纲 m²/s³，ω 量纲 1/s
>  - 值越大，代表能量正快速从大尺度涡向微小尺度衰减
>	
>两者一起决定 湍流粘度 μ_t
>  - k-ε： μ_t = ρ C_μ k² / ε
>  - k-ω： μ_t = ρ k / ω
>
>   因此它们收敛不好，势必影响动量、能量方程的收敛。
>#### 2. 残差是什么 ───────── 
>每走一步迭代，求解器都会离散并求解
>  - ∂(ρk)/∂t + ∇·(ρku) = P_k − ρε + ∇·[(μ+μ_t/σ_k)∇k]
>  - ∂(ρε)/∂t + ∇·(ρεu) = C₁εP_k/k − C₂ερ/k + … (或 ω 方程)
>
>把左、右两边搬到同一侧就是“不平衡量”——对所有网格单元加和或 RMS 后，得到 Tke、Tdr Residual。
>  - Residual 越小 → 方程余量越小 → k、ε 分布越接近真正解
>  - Scaled Residual 通常会从 10⁰ 掉到 10⁻³ ~ 10⁻⁶ (下降 3-4 个数量级即可认为“收敛良好”)
>#### 3. 工程判据 & 常见现象 ────────────
>###### 1. 收敛阈值
>  - 动量 / 连续方程要求 1 E-4 时，k 和 ε/ω 也尽量掉到 ≤1 E-4
>  - 做 RANS+辐射/化学，ε 残差有时 1 E-3 就够，只要监视量稳定
>###### 2. k 很快降而 ε 老降不动？
>  - ε 方程包含 1/ε、ε²/k 等刚性源项，更难收敛
>  - 降低 ε 方程松弛系数或先用一阶步进几十迭代可缓解
>###### 3. Tdr 残差忽然飙升 / NaN
>  - 入口给了负 k、ε，或者墙面 y⁺ 太低，高梯度导致 ε → ∞
>  - 检查初始/边界值、网格 y⁺ 以及 Δt（瞬态）
>###### 4. 使用 k-ω/SST 时
>  - 软件可能显示两条：Tke、Sdr
>  - 有些版本沿袭旧名字，把 ω 残差列在 “Tdr” 行
>  - 判断方法：看你 Physics Continua 里勾的是 k-ε 还是 k-ω
>#### 一页小抄 ───────── 
>  - Tke 残差 → 湍动动能 k 方程未平衡量
>  - Tdr 残差 → 湍动耗散率 ε（或 ω）方程未平衡量
>  - 下降 ≥3 阶 + 关键物理量稳定 ⇒ 湍流子模型可认为收敛
>  - 若 ε/ω 残差卡高位：减松弛、缩时间步、检查 y⁺ & 边界值
---

### 3. 绝对残差 vs. 归一化残差
大多数商业代码（STAR-CCM+、Fluent、CFX …）默认显示的都是 Scaled Residual：  
>ScaledResidual = CurrentResidual / InitialResidual(max 或 avg)
> 
**优点**：不同模型、不同单位下都能“看量级”而不必关心绝对值。  
如果面板还提供 Unscaled 选项，记得两者量级差距很可能多达 5–10 位。

---

### 4. 数学形式：L1 / L2 / RMS / L∞
残差可以做多种范数统计，你常见的多半是 RMS (Root-Mean-Square)，即
>RMS = √( Σ(res_i²) / N )
> 
**优点**：对所有控制体的误差都兼顾而不会被单点异常支配。   
有些软件还会列出 Max (L∞) —— 单独最大的单元残差，用于排查局部爆点。

---

### 5. “掉几阶才算收敛？”
经验规则（稳态计算）  

	1. 主方程（Continuity / Momentum）：至少下降 3–4 个数量级。
	2. 辅助方程（k-ε, Scalars）：通常也需 3 阶；有时 2 阶即可。
	3. 能量方程 较难，一般 1–2 阶足够。
	4. 等 Residual 进入平台期（再跑几百步也几乎不降）+ 关键工程量（压降、力矩）稳定，即可认为收敛。
注：对瞬态计算，残差只需保证每步能逼近“时间离散误差”，不必强求阶数；真正看的应是时间步内的 CFL、质量守恒误差和监视点曲线。

---

### 6. 为什么有时 Continuity 反而最难降？
	1. 可压缩 / 大密度梯度：Continuity 直接含 ρ，波动更大。
	2. 开口边界过多：流量平衡容易因入口 / 出口初猜错而产生漂移。
	3. 耦合求解器松弛过低：压力-速度迭代跟不上动量更新。
	4. 局部网格极差：细网格单元中时间步/松弛冲突，首当其冲反映在 Continuity。
解决思路：加密耦合、减小松弛、先做初级稳压迭代等。

---

### 7. 残差突然反弹/NaN 的常见原因
	1. 数值爆炸（u、T、k 出现无穷大或负根）：检查边界、物性、除 0。
	2. 松弛系数突然增大：从一阶 → 二阶切换时可先“热启动”几十步。
	3. 网格移动/变形：动态网格体积比极限 violated。
	4. 化学/辐射耦合骤然开启：新增源项带入高刚度。按“分区慢启”开启子模型可避免。
---

### 8. 用残差 + 物理监视量双保险
残差毕竟只衡量“方程满足度”，工程决策时同时监控：

	1. 质量流量不平衡 (mass balance)
	2. 关键截面压降 / 旋转机械扭矩
	3. 目标面平均温度 / 力系数
二者都平稳才是“真收敛”。

---

### 9. 一页备忘表
| 任务场景	 | 建议残差收敛目标 |
|:------|:---------|
|普通无压缩，低 Re 管道流	|Continuity/Mom <= 1E-4|
|高雷诺数外部绕流	|同上 + k-ε <= 1E-4|
|气动声学（小尺度噪声）	|Momentum <= 1E-6|
|仅做热浸或换热器（稳态）	|能量 <= 1E-6；其余 1E-4|
|化学反应/燃烧	|连续、动量 1E-3；Species 1E-4|
|瞬态 LES / DNS	|日常看 CFL 与监控，不看阶数|

所有数值仅供起步参考，实际还得与监视量交叉验证

---

### 10. 一句话总结
残差本质上是“离散控制方程的不平衡量”，**_Continuity_** / _**Momentum**_ / **_Energy_** / **_k-ε_** … 各自对应一条守恒或传输方程。 

下降 3–4 个数量级并进入平台 + 工程监视量稳定，即可认为迭代收敛；若残差飙升或 NaN，通常是边界、物性或数值设置导致的爆点。

了解每条残差的物理含义能让你快速定位问题并给出合理的收敛判据。
